function d2fdz = d2z(f,z)

[M,N]=size(f);

d2fdz = zeros(M,N);
% 
% % Second order central
% for i = 1:M
%     if i == 1
%         d2fdz(i,:) = 0;%(f(i,:)-2*f(i,:)+f(i+1,:))./(z(i+1,:)-z(i,:)).^2;
%     elseif i == M
%         d2fdz(i,:) = (f(i-2,:)-2*f(i-1,:)+f(i,:))./(z(i-2,:)-2*z(i-1,:)+z(i,:));
%     else
%         d2fdz(i,:) = (f(i-1,:)-2*f(i,:)+f(i+1,:))./(z(i-1,:)-2*z(i,:)+z(i+1,:));
%     end
% end

% Sixth order central
for i = 1:M
    if i == 1
        d2fdz(i,:) = (1/90*f(i,:)-3/20*f(i,:)+3/2*f(i,:)-49/18*f(i,:)+3/2*f(i+1,:)-3/20*f(i+2,:)+1/90*f(i+3,:))./(z(i+1,:)-z(i,:)).^2;
    elseif i == 2
        d2fdz(i,:) = (1/90*f(i-1,:)-3/20*f(i-1,:)+3/2*f(i-1,:)-49/18*f(i,:)+3/2*f(i+1,:)-3/20*f(i+2,:)+1/90*f(i+3,:))./(z(i+1,:)-z(i,:)).^2;
    elseif i == 3
        d2fdz(i,:) = (1/90*f(i-2,:)-3/20*f(i-2,:)+3/2*f(i-1,:)-49/18*f(i,:)+3/2*f(i+1,:)-3/20*f(i+2,:)+1/90*f(i+3,:))./(z(i+1,:)-z(i,:)).^2;
    elseif i == M-2
        d2fdz(i,:) = (-1/12*f(i-2,:)+16/12*f(i-1,:)-30/12*f(i,:)+16/12*f(i+1,:)-1/12*f(i+2,:))./(z(i+1,:)-z(i,:)).^2;
    elseif i == M-1
        d2fdz(i,:) = (-1/12*f(i-3,:)+4/12*f(i-2,:)+6/12*f(i-1,:)-20/12*f(i,:)+11/12*f(i+1,:)-0*f(i+1,:))./(z(i+1,:)-z(i,:)).^2;
    elseif i == M
        d2fdz(i,:) = (-1*f(i-3,:)+4*f(i-2,:)-5*f(i-1,:)+2*f(i,:))./(z(i,:)-z(i-1,:)).^2;
    else
        d2fdz(i,:) = (1/90*f(i-3,:)-3/20*f(i-2,:)+3/2*f(i-1,:)-49/18*f(i,:)+3/2*f(i+1,:)-3/20*f(i+2,:)+1/90*f(i+3,:))./(z(i+1,:)-z(i,:)).^2;
    end
end

% % Second order backward
% for i = 1:M
%     if i == 1
%         d2fdz(i,:) = (-1*f(i,:)+4*f(i,:)-5*f(i,:)+2*f(i,:))./(z(i+1,:)-z(i,:)).^2;
%     elseif i == 2
%         d2fdz(i,:) = (-1*f(i-1,:)+4*f(i-1,:)-5*f(i-1,:)+2*f(i,:))./(z(i,:)-z(i-1,:)).^2;
%     elseif i == 3
%         d2fdz(i,:) = (-1*f(i-2,:)+4*f(i-2,:)-5*f(i-1,:)+2*f(i,:))./(z(i,:)-z(i-1,:)).^2;
% %     elseif i==M
% %         d2fdz(i,:) = 0;
%     else
%         d2fdz(i,:) = (-1*f(i-3,:)+4*f(i-2,:)-5*f(i-1,:)+2*f(i,:))./(z(i,:)-z(i-1,:)).^2;
%     end
% end

end